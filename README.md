# üå¶ Weather Forecast API ‚Äî Django Backend

–°–µ—Ä–≤–∏—Å –Ω–∞ Django REST Framework –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –ø–æ–≥–æ–¥—ã –∏ –ø—Ä–æ–≥–Ω–æ–∑–∞, —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–æ–≥–Ω–æ–∑–∞ –≤—Ä—É—á–Ω—É—é. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–Ω–µ—à–Ω–∏–π API Weatherbit.io –∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—É—é –ª–æ–≥–∏–∫—É.

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –ø–æ–≥–æ–¥—ã –ø–æ –≥–æ—Ä–æ–¥—É
* –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –¥–∞—Ç—É
* –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é –¥–∞—Ç—É
* –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤—Ä—É—á–Ω—É—é –∑–∞–¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –Ω–∞–¥ –≤–Ω–µ—à–Ω–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
* –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç API –∏ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø—Ä–æ–≥–Ω–æ–∑–æ–≤
* Django Admin –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞–º–∏

---

## üîó –í–Ω–µ—à–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

–°–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç [Weatherbit API](https://www.weatherbit.io/api) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –ø–æ–≥–æ–¥—ã –∏ –ø—Ä–æ–≥–Ω–æ–∑–∞:

- **–¢–µ–∫—É—â–∞—è –ø–æ–≥–æ–¥–∞:** [`/current`](https://www.weatherbit.io/api/weather-current)
- **–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –¥–Ω–∏:** [`/forecast/daily`](https://www.weatherbit.io/api/weather-forecast-16-day)

–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º API-–∫–ª—é—á, –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `WEATHERBIT_API_KEY`.

---

## üì¶ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

* Python 3.12
* Django 5.2.2
* Django REST Framework 3.16.0
* PostgreSQL
* Poetry (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏)
* Ruff (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞)
* Docker + Docker Compose

---

## ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í `.env` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã:

```env
DJANGO_SECRET_KEY=django-insecure-key
DJANGO_DEBUG=True

POSTGRES_USER=fastapi_user
POSTGRES_PASSWORD=fastapi_password
POSTGRES_DB=fastapi_db

WEATHERBIT_API_KEY=your_api_key_here
WEATHERBIT_URL=https://api.weatherbit.io/v2.0

CURRENT_WEATHER_CACHE_TIMEOUT=300
FORECAST_WEATHER_CACHE_TIMEOUT=900
```

---

## üêç Poetry

- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ pipx –∏ Poetry:
  
   ```bash
   pip install --upgrade pip
   pip install pipx
   pipx install poetry
   ```

- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

   ```bash
   poetry install
   ```

---

## üê≥ Docker

- –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞:

   ```bash
   docker-compose up --build
   ```

- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π:

   ```bash
   docker-compose exec django python manage.py migrate
   ```

---

## üîÑ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

- –ö–µ—à —Ç–µ–∫—É—â–µ–π –ø–æ–≥–æ–¥—ã –∏ –ø—Ä–æ–≥–Ω–æ–∑–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ –∫–ª—é—á–∞–º:
  - `current_weather:<city>`
  - `forecast:<city>:<date>`
- –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫–µ—à–∞ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ settings (`CURRENT_WEATHER_CACHE_TIMEOUT`, `FORECAST_WEATHER_CACHE_TIMEOUT`).

---

## ‚úèÔ∏è –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∞

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Ç API –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å `POST` —Å –ø–æ–ª—è–º–∏ `city`, `date`, `min_temperature`, `max_temperature`.  
–û–Ω–∏ –±—É–¥—É—Ç –∏–º–µ—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ –≤–Ω–µ—à–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ –º–æ–¥–µ–ª–∏ `ForecastOverride`.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- `api/` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–µ Django-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- `api/services.py` ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (–∑–∞–ø—Ä–æ—Å—ã –∫ API, –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
- `api/serializers.py` ‚Äî DRF-—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã
- `api/views.py` ‚Äî –≤—å—é—Ö–∏ (REST API)
- `api/models.py` ‚Äî –º–æ–¥–µ–ª—å `ForecastOverride`
- `api/validators.py` ‚Äî –≤–∞–ª–∏–¥–∞—Ç–æ—Ä `validate_forecast_date`
- `api/weather_provider/weatherbit.py` ‚Äî –¥–æ—Å—Ç—É–ø –∫ API Weatherbit

- `src/utils/decorators.py` ‚Äî –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `external_api_error_handler`

---

